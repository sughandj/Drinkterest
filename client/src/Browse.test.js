import React from 'react';
import ReactDOM from 'react-dom';
import Browse from './Browse';
import { expect } from 'chai';
import sinon from 'sinon';
import { configure, mount } from 'enzyme';
import Adapter from 'enzyme-adapter-react-16';

configure({ adapter: new Adapter() });
global.fetch = require('jest-fetch-mock');

it('renders browse loading', () => {
  fetch.mockResponseOnce(JSON.stringify([]));
  fetch.mockResponseOnce(JSON.stringify({}));

  const wrapper = mount((
    <div>
      <Browse/>
    </div>
  ));

  expect(wrapper.contains(
    <h2>Loading...</h2>
  )).to.equal(true);
});

it('renders browse cards', () => {
  fetch.mockResponseOnce(JSON.stringify([]));
  fetch.mockResponseOnce(JSON.stringify({"status":200,"message":null,"pager":{"records_per_page":5,"total_record_count":12382,"current_page_record_count":5,"is_first_page":true,"is_final_page":false,"current_page":1,"current_page_path":"/products?per_page=5\u0026page=1","next_page":2,"next_page_path":"/products?per_page=5\u0026page=2","previous_page":null,"previous_page_path":null,"total_pages":2477,"total_pages_path":"/products?per_page=5\u0026page=2477"},"result":[{"id":311787,"is_dead":false,"name":"Budweiser","tags":"budweiser beer lager canada ontario labatt breweries can","is_discontinued":false,"price_in_cents":1450,"regular_price_in_cents":1450,"limited_time_offer_savings_in_cents":0,"limited_time_offer_ends_on":null,"bonus_reward_miles":0,"bonus_reward_miles_ends_on":null,"stock_type":"LCBO","primary_category":"Beer","secondary_category":"Lager","origin":"Canada, Ontario","package":"6x473 mL can","package_unit_type":"can","package_unit_volume_in_milliliters":473,"total_package_units":6,"volume_in_milliliters":2838,"alcohol_content":500,"price_per_liter_of_alcohol_in_cents":1021,"price_per_liter_in_cents":510,"inventory_count":55375,"inventory_volume_in_milliliters":157154250,"inventory_price_in_cents":80293750,"sugar_content":null,"producer_name":"Labatt Breweries Ontario","released_on":null,"has_value_added_promotion":false,"has_limited_time_offer":false,"has_bonus_reward_miles":false,"is_seasonal":false,"is_vqa":false,"is_ocb":false,"is_kosher":false,"value_added_promotion_description":null,"description":null,"serving_suggestion":null,"tasting_note":null,"updated_at":"2017-12-03T14:19:13.413Z","image_thumb_url":"https://dx5vpyka4lqst.cloudfront.net/products/311787/images/thumb.png","image_url":"https://dx5vpyka4lqst.cloudfront.net/products/311787/images/full.jpeg","varietal":"North American Lager","style":"Light \u0026 Malty","tertiary_category":"Pale Lager","sugar_in_grams_per_liter":null,"clearance_sale_savings_in_cents":0,"has_clearance_sale":false,"product_no":311787},{"id":300681,"is_dead":false,"name":"Coors Light","tags":"coors light beer lager canada ontario molson's molsons brewery of limited can","is_discontinued":false,"price_in_cents":1450,"regular_price_in_cents":1450,"limited_time_offer_savings_in_cents":0,"limited_time_offer_ends_on":null,"bonus_reward_miles":0,"bonus_reward_miles_ends_on":null,"stock_type":"LCBO","primary_category":"Beer","secondary_category":"Lager","origin":"Canada, Ontario","package":"6x473 mL can","package_unit_type":"can","package_unit_volume_in_milliliters":473,"total_package_units":6,"volume_in_milliliters":2838,"alcohol_content":400,"price_per_liter_of_alcohol_in_cents":1277,"price_per_liter_in_cents":510,"inventory_count":53715,"inventory_volume_in_milliliters":152443170,"inventory_price_in_cents":77886750,"sugar_content":null,"producer_name":"Molson's Brewery of Canada Limited","released_on":null,"has_value_added_promotion":false,"has_limited_time_offer":false,"has_bonus_reward_miles":false,"is_seasonal":false,"is_vqa":false,"is_ocb":false,"is_kosher":false,"value_added_promotion_description":null,"description":null,"serving_suggestion":null,"tasting_note":null,"updated_at":"2017-12-03T14:22:10.226Z","image_thumb_url":"https://dx5vpyka4lqst.cloudfront.net/products/300681/images/thumb.png","image_url":"https://dx5vpyka4lqst.cloudfront.net/products/300681/images/full.jpeg","varietal":"Light Lager","style":"Light \u0026 Malty","tertiary_category":"Light Lager","sugar_in_grams_per_liter":null,"clearance_sale_savings_in_cents":0,"has_clearance_sale":false,"product_no":300681},{"id":300699,"is_dead":false,"name":"Molson Canadian","tags":"molson canadian beer lager canada ontario molson's molsons brewery of limited can","is_discontinued":false,"price_in_cents":1350,"regular_price_in_cents":1450,"limited_time_offer_savings_in_cents":100,"limited_time_offer_ends_on":"2017-12-31","bonus_reward_miles":0,"bonus_reward_miles_ends_on":null,"stock_type":"LCBO","primary_category":"Beer","secondary_category":"Lager","origin":"Canada, Ontario","package":"6x473 mL can","package_unit_type":"can","package_unit_volume_in_milliliters":473,"total_package_units":6,"volume_in_milliliters":2838,"alcohol_content":500,"price_per_liter_of_alcohol_in_cents":951,"price_per_liter_in_cents":475,"inventory_count":50993,"inventory_volume_in_milliliters":144718134,"inventory_price_in_cents":68840550,"sugar_content":null,"producer_name":"Molson's Brewery of Canada Limited","released_on":null,"has_value_added_promotion":false,"has_limited_time_offer":true,"has_bonus_reward_miles":false,"is_seasonal":false,"is_vqa":false,"is_ocb":false,"is_kosher":false,"value_added_promotion_description":null,"description":null,"serving_suggestion":null,"tasting_note":null,"updated_at":"2017-12-03T14:31:57.876Z","image_thumb_url":"https://dx5vpyka4lqst.cloudfront.net/products/300699/images/thumb.png","image_url":"https://dx5vpyka4lqst.cloudfront.net/products/300699/images/full.jpeg","varietal":"North American Lager","style":"Light \u0026 Malty","tertiary_category":"Pale Lager","sugar_in_grams_per_liter":null,"clearance_sale_savings_in_cents":0,"has_clearance_sale":false,"product_no":300699},{"id":696161,"is_dead":false,"name":"Busch","tags":"busch beer lager canada ontario labatt breweries can","is_discontinued":false,"price_in_cents":1235,"regular_price_in_cents":1235,"limited_time_offer_savings_in_cents":0,"limited_time_offer_ends_on":null,"bonus_reward_miles":0,"bonus_reward_miles_ends_on":null,"stock_type":"LCBO","primary_category":"Beer","secondary_category":"Lager","origin":"Canada, Ontario","package":"6x473 mL can","package_unit_type":"can","package_unit_volume_in_milliliters":473,"total_package_units":6,"volume_in_milliliters":2838,"alcohol_content":470,"price_per_liter_of_alcohol_in_cents":925,"price_per_liter_in_cents":435,"inventory_count":40320,"inventory_volume_in_milliliters":114428160,"inventory_price_in_cents":49795200,"sugar_content":null,"producer_name":"Labatt Breweries Ontario","released_on":null,"has_value_added_promotion":false,"has_limited_time_offer":false,"has_bonus_reward_miles":false,"is_seasonal":false,"is_vqa":false,"is_ocb":false,"is_kosher":false,"value_added_promotion_description":null,"description":null,"serving_suggestion":null,"tasting_note":null,"updated_at":"2017-12-03T14:19:21.217Z","image_thumb_url":"https://dx5vpyka4lqst.cloudfront.net/products/696161/images/thumb.png","image_url":"https://dx5vpyka4lqst.cloudfront.net/products/696161/images/full.jpeg","varietal":"North American Lager","style":"Light \u0026 Malty","tertiary_category":"Pale Lager","sugar_in_grams_per_liter":null,"clearance_sale_savings_in_cents":0,"has_clearance_sale":false,"product_no":696161},{"id":186510,"is_dead":false,"name":"Corona Extra","tags":"corona extra beer lager mexico region not specified cerveceria modelo sa de cv bottle","is_discontinued":false,"price_in_cents":1325,"regular_price_in_cents":1450,"limited_time_offer_savings_in_cents":125,"limited_time_offer_ends_on":"2017-12-31","bonus_reward_miles":0,"bonus_reward_miles_ends_on":null,"stock_type":"LCBO","primary_category":"Beer","secondary_category":"Lager","origin":"Mexico, Region Not Specified","package":"6x330 mL bottle","package_unit_type":"bottle","package_unit_volume_in_milliliters":330,"total_package_units":6,"volume_in_milliliters":1980,"alcohol_content":459,"price_per_liter_of_alcohol_in_cents":1457,"price_per_liter_in_cents":669,"inventory_count":57484,"inventory_volume_in_milliliters":113818320,"inventory_price_in_cents":76166300,"sugar_content":null,"producer_name":"Cerveceria Modelo Sa de Cv","released_on":null,"has_value_added_promotion":false,"has_limited_time_offer":true,"has_bonus_reward_miles":false,"is_seasonal":false,"is_vqa":false,"is_ocb":false,"is_kosher":false,"value_added_promotion_description":null,"description":null,"serving_suggestion":null,"tasting_note":null,"updated_at":"2017-12-03T14:22:14.020Z","image_thumb_url":"https://dx5vpyka4lqst.cloudfront.net/products/186510/images/thumb.png","image_url":"https://dx5vpyka4lqst.cloudfront.net/products/186510/images/full.jpeg","varietal":"North American Lager","style":"Light \u0026 Malty","tertiary_category":"Pale Lager","sugar_in_grams_per_liter":null,"clearance_sale_savings_in_cents":0,"has_clearance_sale":false,"product_no":186510}],"suggestion":null}));

  const wrapper = mount((
    <div>
      <Browse/>
    </div>
  ));
  
  expect(wrapper.contains(
    <div className="card"><h4 className="card-header">Budweiser</h4><div className="card-body"><h5 className="card-title">Light &amp; Malty</h5><h6 className="card-subtitle text-muted">Canada, Ontario</h6></div><img className="card-image" src="https://dx5vpyka4lqst.cloudfront.net/products/311787/images/thumb.png" alt="Budweiser"/><div className="card-body"><p className="card-text">6x473 mL can</p></div><div className="card-footer text-muted"><button id="311787" type="button" className="btn btn-secondary">Favorite</button></div></div>
  )).to.equal(false);
});
